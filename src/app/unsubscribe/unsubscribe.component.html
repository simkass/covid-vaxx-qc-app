<div class=unsubscribe>
    <div class=unsubscribe-form>
        <form>
            <mat-form-field>
              <mat-label>Email</mat-label>
              <input type="email" matInput [formControl]="emailFormControl" [errorStateMatcher]="matcher" [(ngModel)]='emailAddress'
                     placeholder="Ex. pat@example.com">
              <mat-error *ngIf="emailFormControl.hasError('email') && !emailFormControl.hasError('required')">
                Veuillez fournir une adresse courriel valide
              </mat-error>
              <mat-error *ngIf="emailFormControl.hasError('required')">
                Une adresse courriel est <strong>requise</strong>
              </mat-error>
            </mat-form-field>
          </form>
          <div class=buttons>
            <button mat-flat-button color="primary" [disabled]="emailFormControl.hasError('email') || emailFormControl.hasError('required')" (click)="startUnsubscription()">Se désabonner</button>
          </div>
    </div>
    <div class=confirm-unsubscribe [hidden]="!unsubscriptionNotNeeded">
      <h3>Cette addresse courriel n'est pas abonnée au service Alerte Vaccin. Considérez vous comme étant désabonné.</h3>
    </div>
    <div class=confirm-unsubscribe [hidden]="!unsubscriptionStarted">
        <p>Vous devriez recevoir un code de confirmation par courriel dans les 5 prochaines minutes. Veuillez le fournir dans la boite ci-desous pour compléter le désabonnement.</p>
        <form>
            <mat-form-field>
              <mat-label>Code de confirmation</mat-label>
              <input type="string" matInput [formControl]="codeFormControl" [errorStateMatcher]="matcher" [(ngModel)]='randomCode'
                     placeholder="Ex. 1234">
              <mat-error *ngIf="codeFormControl.hasError('pattern') && !codeFormControl.hasError('required')">
                Veuillez fournir un code valide
              </mat-error>
              <mat-error *ngIf="codeFormControl.hasError('required')">
                Un code de confirmation est <strong>requis</strong>
              </mat-error>
            </mat-form-field>
          </form>
          <div class=buttons>
            <button mat-flat-button color="primary" (click)="completeUnsubscription()">Confirmer</button>
          </div>
    </div>
    <div class=confirm-unsubscribe [hidden]="!unsubscriptionSuccess">
      <h3>Vous avez été désabonné avec succès.</h3>
    </div>
    <div class=confirm-unsubscribe [hidden]="!unsubscriptionFailed">
      <h3>Une erreur est survenue. Le code de confirmation fournie n'est peut-être pas bon.</h3>
    </div>
</div>
